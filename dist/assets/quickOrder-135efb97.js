import{j as e,T as y,r as P,z as U,B as h,b as f,k as b,C as R,e as C,g as E,y as G,d as T,L as Q,c as H,s as K,P as X}from"./index-736c7350.js";import{e as $,f as J}from"./order-3084bc16.js";import{a as V}from"./country-62d1baa0.js";import{a as Y,g as w}from"./user-d70f4f12.js";import{A as q}from"./AddressModal-f37d1ad4.js";import{O as Z}from"./OrderTypeSelect-042712c7.js";import{u as ee}from"./index-e9b1d892.js";import{G as j,l as D,a as W,K as re,p as se}from"./index-d2f8e32e.js";import{B as te}from"./back-8fcc275f.js";import{G as a}from"./Grid-5602fc76.js";import{T as d}from"./TextField-ddf87520.js";import{U as ie,D as ne}from"./DownloadSimple-78a5cf34.js";import{e as le,T as ae,a as oe,b as B,c as x,d as ce}from"./TableRow-6ebdc710.js";import{C as pe}from"./CircularProgress-0c5e9a3e.js";import"./DialogContent-1a200351.js";import"./DialogActions-766d5601.js";const ue=n=>{const{countrys:s}=n;return e.jsxs(e.Fragment,{children:[e.jsx(y,{color:"primary",mb:"20px",children:"SHIPPING INFORMATION"}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(j,{name:"shipping_name",label:"Name",fullWidth:!0,required:!0})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(j,{name:"shipping_email",label:"Email",fullWidth:!0})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(j,{name:"shipping_phone",label:"Phone",fullWidth:!0})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(D,{name:"shipping_country_code",label:"Country",options:s,fullWidth:!0,required:!0})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(j,{name:"shipping_city",label:"City",fullWidth:!0,required:!0})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(j,{name:"shipping_zone",label:"State",fullWidth:!0})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(j,{name:"shipping_postcode",label:"Postal Code",fullWidth:!0,required:!0})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(j,{name:"shipping_address",label:"Address",fullWidth:!0,required:!0})})]})]})},de=ue,he=n=>{const{type:s,children:u,addressInfo:t}=n;return e.jsxs(e.Fragment,{children:[e.jsxs(y,{color:"primary",mb:"20px",textTransform:"uppercase",children:[s," INFORMATION"]}),e.jsxs(a,{container:!0,spacing:2,children:[u&&e.jsx(a,{item:!0,xs:12,children:u}),t&&e.jsxs(e.Fragment,{children:[e.jsx(a,{item:!0,xs:6,children:e.jsx(d,{label:"Client Name",InputLabelProps:{shrink:!0},value:t==null?void 0:t.customerName,inputProps:{readOnly:!0}})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(d,{label:"Short Name",InputLabelProps:{shrink:!0},value:t==null?void 0:t.customerShortName,inputProps:{readOnly:!0}})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(d,{label:"Phone",InputLabelProps:{shrink:!0},value:t==null?void 0:t.telephoneInfo,inputProps:{readOnly:!0}})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(d,{label:"Tax Code",InputLabelProps:{shrink:!0},value:t==null?void 0:t.taxNumber,inputProps:{readOnly:!0}})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(d,{label:"Country",InputLabelProps:{shrink:!0},value:t==null?void 0:t.countryAreaNameEn,inputProps:{readOnly:!0}})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(d,{label:"City",InputLabelProps:{shrink:!0},value:"",inputProps:{readOnly:!0}})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(d,{label:"State",InputLabelProps:{shrink:!0},value:t==null?void 0:t.provinceAreaNameEn,inputProps:{readOnly:!0}})}),e.jsx(a,{item:!0,xs:6,children:e.jsx(d,{label:"Postal Code",InputLabelProps:{shrink:!0},value:t==null?void 0:t.postCode,inputProps:{readOnly:!0}})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(d,{label:"Address",InputLabelProps:{shrink:!0},value:t==null?void 0:t.addressDetail,inputProps:{readOnly:!0},fullWidth:!0})})]})]})]})},L=he,xe="/assets/NotePencil-05c91e5e.svg",me="/assets/Trash-75c58a5c.svg",ge="/assets/check-red-9027cb92.svg",je="/assets/XCircle-a0870a07.svg",ye="/assets/plusx20-b40bc35b.svg",fe="/assets/delete-all-795046ae.svg",be="/assets/upload_disabled-d62306be.svg",Ce=n=>{const[s,u]=P.useState([]),[t,m]=P.useState(!0),{onChange:p}=n,{confirm:k}=U();P.useEffect(()=>{p==null||p(s),s.length==0&&m(!0)},[s]);const _=async(i,o)=>{const c=await R(i);c==0?C("SKU is unavailable",{variant:"error"}):c==1&&(u(s.map((r,l)=>l==o?{...r,status:"Available"}:r)),m(!1))},I=async i=>{const o=i.target.files&&i.target.files[0];if(o){var c=new FormData;c.set("file",o);const r=await $(c);if(Array.isArray(r)){const l=r.map(g=>({sku:g.sku,qty:g.count,checked:!1,status:g.status==1?"Available":"Unavailable"}));u([...s,...l]),m(!1)}i.target.value=""}},S=i=>{k({message:"Are you sure to remove this item?",onConfirm(){u(s.filter((o,c)=>c!=i))}})},O=()=>{s.filter(i=>i.checked).length>0&&k({message:"Are you sure to remove this items?",onConfirm(){u(s.filter(i=>!i.checked))}})};return e.jsxs(e.Fragment,{children:[e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px",children:[e.jsxs(f,{color:"secondary",onClick:O,children:[e.jsx("img",{src:fe}),e.jsx(y,{ml:"4px",children:"Delete"})]}),e.jsxs(h,{display:"flex",justifyContent:"space-between",columnGap:"20px",children:[e.jsxs(f,{color:"success",sx:{fontSize:"1.2rem"},disabled:!t,children:[e.jsxs(y,{component:"label",marginRight:"5px",htmlFor:"upload_order",display:"flex",columnGap:"5px",sx:{cursor:"pointer"},children:["Upload order",e.jsx("img",{src:t?ie:be})]}),e.jsx(d,{type:"file",id:"upload_order",onChange:I,inputProps:{accept:".xls,.xlsx"},sx:{display:"none"}})]}),e.jsxs(f,{href:"/file/orderTemplate.xlsx",children:[e.jsx(y,{marginRight:"5px",children:"Template"}),e.jsx("img",{src:ne})]}),e.jsx(j,{name:"customContractId",placeholder:"Input PO NO.",helperText:"",sx:{"& .MuiInputBase-input":{fontSize:"1.4rem",height:"30px",boxSizing:"border-box"}}})]})]}),e.jsx(le,{children:e.jsxs(ae,{sx:{"& th, td":{fontSize:"1.2rem",color:"text.secondary",fontWeight:500,padding:"0 10px"},"& th":{backgroundColor:"rgba(102,102,102,.2)"}},children:[e.jsx(oe,{children:e.jsxs(B,{children:[e.jsx(x,{width:"10%",children:e.jsx(W,{checked:s.length>0&&(s==null?void 0:s.every(i=>i.checked)),onChange:i=>{u(s.map(o=>({...o,checked:i.target.checked})))}})}),e.jsx(x,{width:"25%",children:"SKU"}),e.jsx(x,{width:"25%",children:"Qty"}),e.jsx(x,{width:"20%",children:"Status"}),e.jsx(x,{width:"10%",children:"Action"})]})}),e.jsxs(ce,{children:[s==null?void 0:s.map((i,o)=>e.jsxs(B,{sx:()=>i.status=="Unavailable"?{"& td":{color:"#66666680"}}:null,children:[e.jsx(x,{children:e.jsx(W,{checked:i.checked,onChange:c=>{u(s.map((r,l)=>l==o?{...r,checked:c.target.checked}:r))}})}),e.jsx(x,{children:i.status=="validing"?e.jsx(d,{value:i.sku,sx:{"& .MuiInputBase-input":{height:"20px",fontSize:"1.2rem",padding:"0 5px"}},helperText:"",autoFocus:!0,onChange:c=>{u(s.map((r,l)=>l==o?{...r,sku:c.target.value}:r))}}):i.sku}),e.jsx(x,{children:i.status=="validing"?e.jsx(d,{value:i.qty,sx:{"& .MuiInputBase-input":{height:"20px",fontSize:"1.2rem",padding:"0 5px"}},type:"number",helperText:"",onChange:c=>{u(s.map((r,l)=>l==o?{...r,qty:Number(c.target.value)}:r))}}):i.qty}),e.jsx(x,{children:i.status=="validing"?e.jsxs(h,{children:[e.jsx(b,{onClick:()=>_(i.sku,o),children:e.jsx("img",{src:ge})}),e.jsx(b,{onClick:()=>S(o),children:e.jsx("img",{src:je})})]}):i.status}),e.jsx(x,{children:i.status!="validing"&&e.jsxs(h,{children:[e.jsx(b,{onClick:()=>{u(s.map((c,r)=>r==o?{...c,status:"validing"}:c))},children:e.jsx("img",{src:xe})}),e.jsx(b,{onClick:()=>S(o),children:e.jsx("img",{src:me})})]})})]},o)),e.jsx(B,{children:e.jsx(x,{colSpan:5,children:e.jsx(b,{sx:{margin:"4px 0"},onClick:()=>u([...s,{sku:"",qty:1,checked:!1,status:"validing"}]),children:e.jsx("img",{src:ye})})})})]})]})})]})},ke=Ce,z=K(X)`
  font-size: 1.2rem;
  font-weight: 500;
  padding: 20px 30px;
  width: 553px;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
`;function Le(){var o,c;const[n,s]=ee({dialogOpen:!0}),{msg:u}=E(),t=G(),{data:m}=T(Y,{ready:!n.dialogOpen}),{data:p}=T(async r=>{if(r=="Dropship"){const l=await w("T6");return l.length==1&&s({billing:l[0]}),{billing:l}}else{const l=await w("T5"),g=await w("T6");return l.length==1&&s({shipping:l[0]}),g.length==1&&s({billing:g[0]}),{shipping:l,billing:g}}},{defaultParams:[n.orderType],ready:!n.dialogOpen}),{data:k,run:_}=T(async()=>{const r=await V();return r==null?void 0:r.map(l=>({id:l.id,label:l.area_name_en}))},{ready:!n.dialogOpen,manual:!0,retryCount:5});P.useEffect(()=>{n.orderType=="Dropship"&&_()},[n.orderType]);const I=r=>{s({orderType:r,dialogOpen:!1})},{loading:S,runAsync:O}=T(J,{manual:!0}),i=async r=>{var l,g,A,N,F,M;if(n.orderType=="Batch order"&&!((l=n.shipping)!=null&&l.partnerCode)&&C("Please select Shipping Information",{variant:"error"}),!((g=n.billing)!=null&&g.partnerCode)){C("Please select Billing Information",{variant:"error"});return}if((((A=n.skuItems)==null?void 0:A.length)??0)>0){if(!((N=n.skuItems)!=null&&N.every(v=>v.status=="Available"))){C("Product information is incorrect",{variant:"error"});return}}else{C("No product information",{variant:"error"});return}await O({skuItems:n.skuItems.map(v=>({sku:v.sku,count:v.qty})),shipTo:((F=n.shipping)==null?void 0:F.partnerCode)??"",billTo:((M=n.billing)==null?void 0:M.partnerCode)??"",shipping_name:r.shipping_name??"",shipping_email:r.shipping_email??"",shipping_phone:r.shipping_phone??"",shipping_country_code:r.shipping_country_code??"",shipping_city:r.shipping_city??"",shipping_zone:r.shipping_zone??"",shipping_postcode:r.shipping_postcode??"",shipping_address:r.shipping_address??"",fulfillmentChannelCode:r.fulfillmentChannelCode??"",orderTypeCode:n.orderType??"",tradeClauseCode:r.tradeClauseCode??"",pricingTradeClauseCode:r.pricingTradeClauseCode??"",customContractId:r.customContractId??""}),u({message:"Order placed, please go to My Orders to confirm!",onConfirm(){t("/account/orders")}})};return e.jsxs(Q,{title:"Quick Order",children:[e.jsx(Z,{open:n.dialogOpen,onSelect:I}),n.orderType&&e.jsxs(re,{onSuccess:i,children:[e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",children:[e.jsxs(h,{display:"flex",columnGap:"60px",alignItems:"center",fontSize:"1.2rem",fontWeight:500,color:"text.secondary",children:[e.jsxs(f,{onClick:()=>t(-1),children:[e.jsx("img",{src:te}),e.jsxs(y,{fontSize:"1.2rem",ml:1,children:["Back to ",e.jsx("b",{children:"My Orders"})]})]}),n.orderType=="Batch order"&&e.jsx(h,{sx:r=>({["& > .MuiFormControl-root"]:{flexDirection:"row",alignItems:"center",margin:0,fontSize:"1.2rem",fontWeight:500,color:r.palette.text.secondary,"& .MuiFormLabel-root":{color:"rgba(0,116,163,.8)",fontSize:"1.4rem",fontWeight:500,marginRight:1},"& .MuiButtonBase-root":{padding:"0 2px 0 8px"},"& .MuiFormHelperText-root, .MuiFormLabel-asterisk":{display:"none"}}}),children:e.jsx(se,{label:"Shipment method: ",name:"fulfillmentChannelCode",row:!0,required:!0,options:[{id:"代发",label:"Ship by supplier"},{id:"自提",label:"Self-pickup"}]})}),e.jsxs(h,{sx:{display:"flex"},children:[e.jsx(y,{marginRight:1,children:"Price Term:"}),e.jsx(y,{children:m==null?void 0:m.eya_t2.tradeClauseCodePrice}),e.jsx(j,{name:"pricingTradeClauseCode",value:m==null?void 0:m.eya_t2.tradeClauseCodePrice,sx:{display:"none"}})]}),e.jsxs(h,{sx:{display:"flex"},alignItems:"center",children:[e.jsxs(h,{sx:{display:"flex"},marginRight:1,children:[e.jsx(y,{color:"secondary",children:"*"}),"Trade term"]}),e.jsx(D,{name:"tradeClauseCode",required:!0,options:["EXW","DDP","DDU"].map(r=>({id:r,label:r})),sx:{width:"77px",fontSize:"1.2rem","& .MuiInputBase-root":{height:"25px"},"& .MuiFormHelperText-root, .MuiFormLabel-asterisk":{display:"none"},"& .MuiInputBase-input":{fontSize:"1.2rem"}}})]})]}),e.jsx(h,{children:e.jsx(f,{color:"success",type:"submit",children:"Submit"})})]}),e.jsxs(h,{display:"flex",justifyContent:"center",gap:"46px",flexWrap:"wrap",children:[e.jsx(z,{children:n.orderType=="Dropship"?e.jsx(de,{countrys:k}):e.jsx(L,{type:"shipping",addressInfo:n.shipping,children:(((o=p==null?void 0:p.shipping)==null?void 0:o.length)??0)>1&&e.jsx(q,{type:"shipping",addresses:(p==null?void 0:p.shipping)??[],onSelect:r=>{s({shipping:r})},trigger:e.jsx(f,{sx:{marginBlockEnd:"25px"},children:"Select Billing Information"})})})}),e.jsx(z,{children:e.jsx(L,{type:"billing",addressInfo:n.billing,children:(((c=p==null?void 0:p.billing)==null?void 0:c.length)??0)>1&&e.jsx(q,{type:"billing",addresses:(p==null?void 0:p.billing)??[],onSelect:r=>{s({billing:r})},trigger:e.jsx(f,{sx:{marginBlockEnd:"25px"},children:"Select Billing Information"})})})}),e.jsx(z,{sx:{width:"80%"},children:e.jsx(ke,{onChange:r=>{s({skuItems:r})}})})]})]}),e.jsx(H,{sx:{color:"#fff",zIndex:r=>r.zIndex.drawer+1},open:S,children:e.jsx(pe,{color:"inherit"})})]})}export{Le as default};
